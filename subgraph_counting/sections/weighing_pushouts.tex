\section{Measuring graphs by counting morphisms from specific graphs}
\label{subgraph_counting:sec:interpretation}
\index{Ruler-graph!morphism counting}
Let $\mathcal{R} \mathop{=} \mathcal{A} \mathop{\cup} \mathcal{B}$ be a set of injective rules.
Define $\opn{Sub}(\opn{left}(\mathcal{R}))$ as the set of all subgraphs of left-hand sides of rules in $\mathcal{R}$.
We call the elements of $\opn{Sub}(\opn{left}(\mathcal{R}))$~\textbf{ruler-graphs}. Ruler-graphs in a set $\mathbb{X}$ provide a measure for a graph
$G$, and the total weight of $G$ is determined by a weighted linear
combination of these measures.

\begin{definition} 
    \label{subgraph_counting:def:measurement}
    \index{Measurement of object!morphism counting}
    For a ruler-graph \( X \) and a graph \( G \), the \textbf{measurement} \( m_X(G) \) is defined as the number of $X$-occurrences in $G$, i.e. the cardinality of the set of monomorphisms from $ X $ to $ G $:
    \(
        m_X(G) \mathop{=} \card{\operatorname{Mono}(X, G)}
    \).
\end{definition} 
Counting monomorphisms from ruler-graphs before and after a rewriting step provides a termination criterion: 
    If there is a ruler-graph $X$ such that every rewriting step using a rule in $\mathcal{A}$ strictly decreases the number of monomorphisms from $X$, and every rewriting step using a rule in $\mathcal{B}$ never increases it, then the rewriting relation induced by $\mathcal{A}$ terminates relative to the rewriting relation induced by $\mathcal{B}$.
 
For some ruler-graphs, the change in the number of monomorphisms when applying a rewriting step using an injective rule is precisely computable by simply counting the numbers of monomorphisms from these ruler-graphs in the left- and right-hand side graphs. 

Examples include: 
\begin{itemize}
    \item  the ruler-graph \tikz[baseline=-0.5ex]{
        \node[draw,circle] (x) at (0,0) {};
    } consisting of a single node;
    \item the ruler-graph \tikz[baseline=-0.5ex]{
        \node[draw,circle] (x) at (0,0) {};
        \draw[->] (x) edge[loop right] node[midway, right] {$x$} (x) ;
    } consisting of a single node and a single loop labeled by $x\in \Sigma$; 
    \item the ruler-graph \tikz[baseline=-0.5ex]{
        \node[draw,circle] (x) at (0,0) { };
        \node[draw,circle] (y) at (1,0) { };
        \draw[->] (x) -- (y) node[midway, above] {$x$};
    } consisting of two nodes and a single labeled edge between them.  
\end{itemize}
    
However, systems like Example~\ref{subgraph_counting:ex:grsaa_rx} require more complex ruler-graphs such as \tikz[baseline=-0.5ex]{
        \node[draw,circle] (x) at (0,0) {};
        \node[draw,circle] (y) at (1,0) {};
        \node[draw,circle] (z) at (2,0) {};
        \draw[->] (x) -- (y) node[midway, above] {$a$};
        \draw[->] (y) -- (z) node[midway, above] {$a$};
    },
    because neither the number of nodes nor the number of edges decreases in every possible rewriting step.
    For such a ruler-graph, the change in the number of monomorphisms when applying a rewriting rule is unpredictable in general, because the number of monomorphisms 
    % from such ruler-graph 
    depends on the context graph\textemdash a challenge that we address in later sections.
    
To combine measurements from multiple ruler-graphs (analogous to combining measurements of physical objects from multiple rulers), we introduce a weight function that assigns a weight to each ruler-graph.
\begin{definition} 
    \label{subgraph_counting:def:weight_function}
    \index{Weight function}
    A \textbf{weight function} for a set of ruler-graphs \( \mathbb{X} \) is a map \( s_{\mathbb{X}} \mathop{\colon} \mathbb{X} \mathop{\to} \mathbb{N} \) assigning a weight in $\mathbb{N}$ to each ruler-graph. The weight of a monomorphism from a ruler-graph $X$ is defined to be $s_\mathbb{X}(X)$. 
\end{definition}

\begin{definition} 
    \label{subgraph_counting:def:graph_weight}  
    \index{Graph weight!morphism counting}
    Let \( \mathbb{X} \) be a set of ruler-graphs, 
    \( s_{\mathbb{X}} \) a weight function, and \( G \) a graph. The \textbf{weight of graph} \( G \) relative to \( s_{\mathbb{X}} \), denoted by \( w_{s_{\mathbb{X}}}(G) \), is defined as: 
    \[
        w_{s_{\mathbb{X}}}(G) \mathop{=} \sum_{X \mathop{\in} \mathbb{X}} s_{\mathbb{X}}(X) \cdot m_X(G).  
    \]  
\end{definition} 
Assigning different weights to measurements from distinct ruler-graphs enhances the technique, as we will demonstrate in Example~\ref{ex:overbeek_5d6}.
\section{General idea and key challenge}
\label{subgraph_counting:sec:general_idea}
For the remainder of this section, we fix a set \( \mathcal{R} \mathop{=} \mathcal{A} \mathop{\cup} \mathcal{B} \) of injective DPO rewriting rules, a set \( \mathbb{X} \) of ruler-graphs, and a weight function \( s_{\mathbb{X}} \).  Let \( \rho \mathop{=} (L \overset{l}{\leftarrowtail} K \overset{r}{\rightarrowtail} R) \) denote a rule in \( \mathcal{R} \) and \( X \mathop{\in} \mathbb{X} \). 
Recall that \(\mathfrak{M}\), defined in Definition~\ref{def:rewriting_framework}, denotes the DPO rewriting framework that associates each rule with the collection of all DPO diagrams witnessing rewriting steps using the rule, where the matches are monic.

The rewriting relation \( \mathop{\Rightarrow}_{\mathcal{A},\mathfrak{M}} \) terminates relative to $\mathop{\Rightarrow}_{\mathcal{B},\mathfrak{M}}$ if the following conditions hold:
\begin{itemize}
    \item for all \(G \mathop{\Rightarrow}_{\mathcal{A},\mathfrak{M}} H\), \( w_{s_\mathbb{X}}(G) \mathop{>} w_{s_\mathbb{X}}(H) \), and
    \item for all \(G \mathop{\Rightarrow}_{\mathcal{B},\mathfrak{M}} H\), \( w_{s_\mathbb{X}}(G) \mathop{\geq} w_{s_\mathbb{X}}(H) \).
\end{itemize}   
However, directly verifying all rewriting steps is infeasible due to their potential infiniteness. 
Thus, we aim to provide a rule-based sufficient condition for termination.
\begin{notation}
    \label{subgraph_counting:notation:mono_sets}
 The disjoint union of two sets \( S \) and \( S' \) will be denoted by \( S \uplus S' \). Let \( X, A, B, G \) be graphs, and let \( \alpha \mathop{\colon} A \mathop{\to} G \) and \( \beta \mathop{\colon} B \mathop{\to} G \) be morphisms shown below:
\begin{center}
    \resizebox{0.4\textwidth}{!}{
            \begin{tikzpicture}
            \node (X) at (-1.5,-1) {$X$};
            \node (B) at (2,0) {$A$}; 
            \node (C) at (0,2) {$B$}; 
            \node (D) at (0,0) {$G$}; 
            \draw [>->] (B) to node [above,label,pos=0.45] {$\alpha$} (D); 
            \draw [>->] (C) to node [right,label,pos=0.45] {$\beta$} (D);
            \draw [>->,dashed] (X) to node [above,label,pos=0.45] {$\iota$} (D);
            \draw [>->,dashed] (X) to node [below,label,pos=0.45] {$\zeta$} (B);
            \draw [>->,dashed] (X) to node [above,label,pos=0.45] {$\eta$} (C);
        \end{tikzpicture}
    }
\end{center}
 We define the following sets:
 \index{mono(@$\operatorname{Mono}(X,G,\alpha)$}
 \index{mono(@$\operatorname{Mono}(X,G,\lnot \alpha)$}
 \index{mono(@$\operatorname{Mono}(X,G,\lnot \alpha, \beta)$}
 \index{mono(@$\operatorname{Mono}(X,G,\lnot \alpha, \lnot \beta)$}  
    \begin{align*}
        \operatorname{Mono}(X,G,\alpha) &= \left\{ \iota \mathop{\colon} X \rightarrowtail G \;\middle|\; \exists \zeta \mathop{\colon} X \rightarrowtail A.\, \iota \mathop{=} \zeta \mathop{\star} \alpha \right\},
        \\
        \operatorname{Mono}(X,G,\lnot \alpha) &= \left\{ \iota \mathop{\colon} X \rightarrowtail G \;\middle|\; \nexists \zeta \mathop{\colon} X \rightarrowtail A.\, \iota \mathop{=} \zeta \mathop{\star} \alpha \right\},
        \\
        \operatorname{Mono}(X,G,\lnot \alpha, \beta) &= \left\{ 
            \iota \mathop{\colon} X \rightarrowtail G \;\middle|\; 
                \begin{aligned}  
                    &(\nexists \zeta \mathop{\colon} X \rightarrowtail A.\, \iota \mathop{=} \zeta \mathop{\star} \alpha) \\ 
                    &\land (\exists \eta \mathop{\colon} X \rightarrowtail B.\, \iota \mathop{=} \eta \mathop{\star} \beta)
                \end{aligned}
        \right\},
        \\
        \operatorname{Mono}(X,G,\lnot \alpha, \lnot \beta) &= \left\{ 
            \iota \mathop{\colon} X \rightarrowtail G \;\middle|\; 
                \begin{aligned}
                    &(\nexists \zeta \mathop{\colon} X \rightarrowtail A.\, \iota \mathop{=} \zeta \mathop{\star} \alpha) \\
                    &\land (\nexists \eta \mathop{\colon} X \rightarrowtail B.\, \iota \mathop{=} \eta \mathop{\star} \beta)
                \end{aligned}
        \right\}.
    \end{align*}
\end{notation}
Consider a rewriting step \( G \mathop{\Rightarrow}_{\rho,\mathfrak{M}} H \) defined by the DPO diagram:
\begin{center}
     \begin{tikzpicture}
            \node (I) at (0,0) {$K$};
            \node (L)  at (-2,0) {$L$};
            \node (R)  at (2,0) {$R$};
            \node (G)  at (-2,-2) {$G$};
            \node (C)  at (0,-2) {$C$};
            \node (H)  at (2,-2) {$H$};
            \draw [>->] (I) to  node [midway,below] {$l$} (L);
            \draw [>->] (I) to  node [midway,below] {$r$} (R);
            \draw [>->] (L) to node [midway,right] {$m$} (G);
            \draw [>->] (I) to  node [midway,right] 
            {} (C);
            \draw [>->] (R) to  node [midway,right] 
            {$m'$}
            (H);
            \draw [>->] (C) to node [midway,above] {$l'$} (G);
            \draw [>->] (C) to node [midway,above] 
            {$r'$} 
            (H);
            % \node [at=($(I)!.5!(G)$)] {\normalfont PO};
            % \node [at=($(I)!.5!(H)$)] {\normalfont PO};
        \end{tikzpicture}
\end{center}
 The sets of monomorphisms \( \operatorname{Mono}(X,G) \) and \( \operatorname{Mono}(X,H) \) can be decomposed into the following disjoint unions:
\begin{flalign*}
    \operatorname{Mono}(X,G) &= 
    \operatorname{Mono}(X,G,l')
    \uplus
    \operatorname{Mono}(X,G,\lnot l',m) 
    \uplus
    \operatorname{Mono}(X,G,\lnot l',\lnot m),
    \\
    \operatorname{Mono}(X,H) &= 
    \operatorname{Mono}(X,H,r')
    \uplus
    \operatorname{Mono}(X,H,\lnot r',m') 
    \uplus
    \operatorname{Mono}(X,H,\lnot r',\lnot m').
\end{flalign*}
Thus, the following equalities hold:
\begin{flalign*}
    \card{\operatorname{Mono}(X,G)} ={} &
    \card{\operatorname{Mono}(X,G,l')}
    +
    \card{\operatorname{Mono}(X,G,\lnot l',m)}
     \\
    &+
    \card{\operatorname{Mono}(X,G,\lnot l',\lnot m)},
    \\
    \card{\operatorname{Mono}(X,H)} ={} &
    \card{\operatorname{Mono}(X,H,r')} 
    +
    \card{\operatorname{Mono}(X,H,\lnot r',m')} \\
    &+\card{\operatorname{Mono}(X,H,\lnot r',\lnot m')}.
\end{flalign*}
 The following lemma provides a way to rewrite the terms $\card{\operatorname{Mono}(X,G)}$ and $\card{\operatorname{Mono}(X,H)}$.
\begin{lemma}
    \label{subgraph_counting:lem:decomp_w_u}
        Let $X$ be a ruler-graph. For a pushout square:
        \begin{center}
            \begin{tikzpicture}
            \node (A) at (0,0) {$A$};
            \node (B) at (0,-2) {$B$}; 
            \node (C) at (-2,0) {$C$}; 
            \node (D) at (-2,-2) {$D$}; 
            \draw [>->] (A) to node [right,label,pos=0.5] {$\alpha$} (B);
            \draw [>->] (A) to node [above,label,pos=0.5] {$\beta$} (C);
            \draw [>->] (B) to node [below,label,pos=0.45] {$\beta'$} (D); 
            \draw [>->] (C) to node [left,label,pos=0.45] {$\alpha'$} (D);
        \end{tikzpicture}
        \end{center}
         the following equalities hold:
        % $\card{\operatorname{Mono}(X, B)} \mathop{=} \card{\operatorname{Mono}(X, D, \beta')}$ and $\card{\operatorname{Mono}(X, C, \lnot \beta)} \mathop{=} \card{\operatorname{Mono}(X, D, \lnot \beta', \alpha')}$.
        \begin{flalign*}
            \card{\operatorname{Mono}(X, B)} &= \card{\operatorname{Mono}(X, D, \beta')},
            \\
            \card{\operatorname{Mono}(X, C, \lnot \beta)} &= \card{\operatorname{Mono}(X, D, \lnot \beta', \alpha')}.
        \end{flalign*}
\end{lemma}
\begin{proof} 
        See~\textsection~\ref{subgraph_counting:proof:dcomp_w_u}.
\end{proof}
By Lemma~\ref{subgraph_counting:lem:decomp_w_u}, the following equalities hold:
\begin{flalign*}
&\card{\operatorname{Mono}(X,G)} =
\card{\operatorname{Mono}(X,C)}
+
\card{\operatorname{Mono}(X,L, \lnot l)}
+
\card{\operatorname{Mono}(X,G, \lnot l',\lnot m)},
 \\
 &\card{\operatorname{Mono}(X,H)} =
 \card{\operatorname{Mono}(X,C)}
 +
 \card{ \operatorname{Mono}(X,R, \lnot r) }
 +
 \card{ \operatorname{Mono}(X,H, \lnot r',\lnot m')}.  
\end{flalign*}
Therefore, we obtain:
\begin{flalign*}
      \card{\operatorname{Mono}(X,G)} -  \card{\operatorname{Mono}(X,H)}
     =& \card{\operatorname{Mono}(X,L, \lnot l)}- \card{\operatorname{Mono}(X,R, \lnot r)} \mathop{+}\\ 
     &\card{\operatorname{Mono}(X,G, \lnot l',\lnot m)} - 
     \card{\operatorname{Mono}(X,H, \lnot r',\lnot m') } 
\end{flalign*}
The following lemma provides a way to rewrite the term $\card{\operatorname{Mono}(X,L, \lnot l)}- \card{\operatorname{Mono}(X,R, \lnot r)}$.
\begin{lemma}
    \label{subgraph_counting:lem:xlnlmxrnr}
    Let $X$ be a graph. Let $L \overset{l}{\leftarrowtail} K \overset{r}{\rightarrowtail} R$ be an injective DPO graph rewriting rule. We have 
    \[
       \card{\operatorname{Mono}(X, L, \lnot l)}  - \card{\operatorname{Mono}(X, R, \lnot r)} 
       \mathop{=} 
       \card{\operatorname{Mono}(X, L)}  - \card{\operatorname{Mono}(X, R)} 
        \]
\end{lemma}
\begin{proof}
        See~\textsection~\ref{subgraph_counting:proof:lem:xlnlmxrnr}.
\end{proof}
By Lemma~\ref{subgraph_counting:lem:xlnlmxrnr}, the following equalities hold:
\begin{flalign*}
     \card{\operatorname{Mono}(X,G)} -  \card{\operatorname{Mono}(X,H)}
    \mathop{=} &\card{\operatorname{Mono}(X,L)}- \card{\operatorname{Mono}(X,R)} \mathop{+}\\ 
      &\card{\operatorname{Mono}(X,G, \lnot l',\lnot m)} - 
    \card{\operatorname{Mono}(X,H, \lnot r',\lnot m') } 
\end{flalign*}
Consequently, the weight difference satisfies:
\begin{flalign*}
       &w_{s_\mathbb{X}}(G) - w_{s_\mathbb{X}}(H)\\
    \overset{\operatorname{def}}{=}&\sum_{X \mathop{\in} \mathbb{X}}^{}s_\mathbb{X}(X) * m_X(G) - \sum_{X \mathop{\in} \mathbb{X}}^{}s_\mathbb{X}(X) * m_X(H)\\
    \overset{\operatorname{def}}{=}&\sum_{X \mathop{\in} \mathbb{X}}^{}s_\mathbb{X}(X) * |\operatorname{Mono}(X,G)| - \sum_{X \mathop{\in} \mathbb{X}}^{}s_\mathbb{X}(X) * |\operatorname{Mono}(X,H)|\\
    =&\sum_{X \mathop{\in} \mathbb{X}}^{}s_\mathbb{X}(X) * \left( \card{\operatorname{Mono}(X,G)} -  \card{\operatorname{Mono}(X,H)} \right)\\
    =&\sum_{X \mathop{\in} \mathbb{X}}^{}s_\mathbb{X}(X) * \left(  \card{\operatorname{Mono}(X,L)}- \card{\operatorname{Mono}(X,R)} \right)+\\
       & \sum_{X \mathop{\in} \mathbb{X}}^{}s_\mathbb{X}(X) * \left( 
     \card{\operatorname{Mono}(X,G, \lnot l',\lnot m)} - 
    \card{\operatorname{Mono}(X,H, \lnot r',\lnot m') } \right).
\end{flalign*}
Since $\sum_{X \mathop{\in} \mathbb{X}}^{}s(X) * \left(  \card{\operatorname{Mono}(X,L)}- \card{\operatorname{Mono}(X,R)} \right)$ can be precisely computed, the key challenge is to establish a lower bound for
\begin{flalign*}
    % \label{ineq:key_challenge}
    \sum_{X \mathop{\in} \mathbb{X}}^{} s_\mathbb{X}(X) * 
         \left ( \card{\operatorname{Mono}(X,G, \lnot l',\lnot m)} - 
     \card{\operatorname{Mono}(X,H, \lnot r',\lnot m') } \right ).
    % \label{ineq:ge0_sss}
\end{flalign*} 
In the next section, we introduce the concept of non-increasing rules, which helps to address this challenge.
\section{Non-increasing rules}
\label{subgraph_counting:sec:non-increasing}
We define the set \(D(R,X)\) of all subgraphs of \( R \) which, when glued along some common interface elements with a subgraph $C'$ of a context graph \( C \), can form an implicit \( X \)-occurrence.

\begin{definition}
    \label{subgraph_counting:def:rx}\index{Distinguished subgraphs of the right-hand side graph}
    Let \(X\) be a graph and 
    \(
        L \overset{l}{\leftarrowtail} K \overset{r}{\rightarrowtail} R
    \) an injective DPO rewriting rule.
    %  such that $l$ is edge-injective and $r$ is node-injective.
    The \textbf{set \(D(R,X)\)\index{\(D(R,X)\)} of distinguished subgraphs of the right-hand side graph} consists of all subgraphs \( R' \mathop{\subseteq} R \)
    satisfying the following conditions:
    \begin{enumerate}
        \item there are graphs $K'$, $C'$ and morphisms such that the following diagram can be constructed, where $h_{K'K}$ and $h_{R'R}$ are inclusion functions:
        \begin{center}
            \resizebox{0.4\textwidth}{!}{
                \begin{tikzpicture}
                    \node (k) at (0, 0) {K};
                    \node (r) at (0, 2) {R};
                    \node (r') at (2,2) {$R'$};
                    \node (k') at (2,0) {K'};
                    \node (x) at (4,2) {X};
                    \node (c') at (4,0) {C'};
                    \node () [at=($(r)!0.5!(k')$)] {$PB$};
                    \node () [at=($(x)!0.5!(k')$)] {$PO$};
                    \draw[>->] (k) -- (r) node[pos= .5, left] {$r$}; 
                    \draw[>->] (r') -- (r) node[pos= .5, above] {$h_{R'R}$};
                    \draw[>->] (k') -- (k) node[pos= .5, below] {$h_{K'K}$};
                    \draw[>->] (k') -- (r');
                    \draw[>->] (k') -- (c');
                    \draw[>->] (c') -- (x);
                    \draw[>->] (r') -- (x);
                \end{tikzpicture}
            }
        \end{center}
        \item $R'$ is not a subgraph of $r(K)$,
        \item $R'$ is not isomorphic to $X$.
    \end{enumerate}
\end{definition}  
The first condition ensures that any $R' \mathop{\in} D(R,X)$ can be glued along some common interface elements with a subgraph $C'$ of a context graph \( C \) to form an \( X \)-occurrence.
The second and third conditions ensure that such $X$-occurrences are included neither in \( C \) nor in \( R \), thereby guaranteeing that they are implicit.  

\begin{example}
    \label{subgraph_counting:ex:grsaa_rx}
    Consider the rewriting rule~\cite[Example 6]{bruggink2014termination}:

    % \begin{center}
        % \resizebox{\textwidth}{!}{
        \vspace{1mm}
        \begin{tikzpicture}
            \graphbox{$L$}{0mm}{0mm}{34mm}{15mm}{2mm}{-5mm}{
                \coordinate (o) at (0mm,-3mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                \node[draw,circle] (l3) at ($(l1)+(1,0)$) {3};
                \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                \draw[->] (l3) -- (l2) node[midway,above] {$a$};
            }     
            \graphbox{$K$}{40mm}{0mm}{24mm}{15mm}{2mm}{-5mm}{
                \coordinate (o) at (5mm,-3mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
            }    
            \graphbox{$R$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                \coordinate (o) at (-5mm,-3mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                \draw[->] (l3) -- (l4) node[midway,above] {$b$};
                \draw[->] (l4) -- (l2) node[midway,above] {$a$};
            }    

            \node () at (37mm,-8mm) {$\leftarrowtail$};
            \node () at (67mm,-8mm) {$\rightarrowtail$};
        \end{tikzpicture}
        % }
    % \end{center}

    Let $X$ be \tikz[baseline=-0.5ex]{
        \node[draw,circle] (x) at (0,0) { };
        \node[draw,circle] (y) at (1,0) { };
        \node[draw,circle] (z) at (2,0) { };
        \draw[->] (x) -- (y) node[midway, above] {$a$};
        \draw[->] (y) -- (z) node[midway, above] {$a$};
    } and $R' \mathop{\in} D(R,X)$. 
    Firstly, $R'$ is neither the empty graph nor isomorphic to $X$, by Conditions 2 and 3 of Definition~\ref{subgraph_counting:def:rx}. 
    Secondly, $R'$ must contain node $4$ or node $5$
    to avoid being a subgraph of $r(K)$ (Condition 2). 
    Thirdly, if $R'$ contains nodes $4$ or $5$, they must be connected to node $1$ or node $2$ respectively, otherwise $R'$ would be disconnected and it would be impossible to construct the diagram in the first condition of Definition~\ref{subgraph_counting:def:rx}.
    Fourthly, $R'$ must not contain 
            \tikz[baseline=-0.5ex]{ 
            \node[draw,circle] (x) at (0,0) {4}; 
            \node[draw,circle] (y) at (1,0) {5};
            \draw[->] (x) -- (y) node[midway, above] {$b$};
    }
    by Condition 1.
    Finally, the following graph can not be $R'$
     because it violates Condition 1.
    % \begin{figure}[H]
    %     \centering
    \begin{center}
        \resizebox{0.4\textwidth}{!}{
            \begin{tikzpicture}
                \graphbox{}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                    \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                }    
            \end{tikzpicture}
        }
        \end{center}
    Thus, $D(R,X)$ consists of the four graphs $R'_1$, $R'_2$, $R'_3$ and $R'_4$:
        \begin{center}
        \resizebox{0.8\textwidth}{!}{
            \begin{tikzpicture}
                \graphbox{$R'_1$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[circle] (l1) at ($(o)+(-10mm,0mm)$) {};
                    \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                    \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
            \end{tikzpicture}
            \begin{tikzpicture}
                \graphbox{$R'_2$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                    \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
            \end{tikzpicture}
        }
        \end{center}
        \vspace{-5mm}
        \begin{center}
            \resizebox{0.8\textwidth}{!}{
                \begin{tikzpicture}
                        \graphbox{$R'_3$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                            \coordinate (o) at (-5mm,-3mm); 
                            \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                            \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                            \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                        }   
                \end{tikzpicture}
            \begin{tikzpicture}
                \graphbox{$R'_4$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                }    
            \end{tikzpicture}
        }
        \end{center}
    For each of them, the construction of the pullback square in Condition 1 is demonstrated in Example~\ref{example:grs_aa:has_more_left} and the construction of the pushout square required by Condition 1 is straightforward. 
        
 
\end{example} 
 
\begin{example}
    \label{subgraph_counting:ex:rx_counter_ex}
    Let $X$ be the graph 
    \tikz[baseline=-0.5ex]{ 
            \node[draw,circle] (x) at (0,0) { }; 
            \node[draw,circle] (y) at (1,0) { };
            \node[draw,circle] (z) at (2,0) { };
            \draw[->] (x) -- (y)   {};
            \draw[->] (y) -- (z)   {};
    }. Consider the following rule:
    \begin{center}
        \resizebox{\textwidth}{!}{
            \begin{tikzpicture}
                \graphbox{$L$}{0mm}{0mm}{34mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (0mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    % \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {2};
                    \draw[->] (l3) -- (l1) node[midway,above] {};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$K$}{40mm}{0mm}{24mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {$\ $};
                    \draw[->] (l2) -- (l1) node[midway,above] {};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$R$}{70mm}{0mm}{40mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    % \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {2};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {3};
                    \draw[->] (l3) -- (l1) node[midway,above] {};
                    \draw[->] (l3) -- (l4) node[midway,above] {};
                    % \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
                \node () at (37mm,-8mm) {$\leftarrowtail$};
                \node () at (67mm,-8mm) {$\rightarrowtail$};
            \end{tikzpicture}
        }
    \end{center}
    Let $R' \mathop{\in} D(R,X)$. $R'$ must contain node 3, otherwise it would be a subgraph of $r(K)$, violating Condition 2 of Definition~\ref{subgraph_counting:def:rx}. Node 3 must be connected to an interface node, otherwise Condition 1 of Definition~\ref{subgraph_counting:def:rx} would be violated. Therefore, $R'$ must include \raisebox{2pt}{\scalebox{0.6}{\tikz[baseline=-0.5ex]{
        \node [draw,circle] (x) at (0,0) {2};
        \node[draw,circle] (y) at (1,0) {3};
        \draw[->] (x) -- (y) {};
    }}}.
    The graph $R$ is not in $D(R,X)$ because it violates Condition 1. Thus, the set \( D(R,X) \) consists of the following graphs:
    \begin{itemize}
        \item $R'_1$:
    \raisebox{2pt}{\scalebox{0.6}{\tikz[baseline=-0.5ex]{
        \node [draw,circle] (x) at (0,0) {2};
        \node[draw,circle] (y) at (1,0) {3};
        \draw[->] (x) -- (y) {};
    }}},  
        \item $R'_2$:
    \raisebox{2pt}{\scalebox{0.6}{\tikz[baseline=-0.5ex]{
        \node [draw,circle] (node1) at (-1,0) {1};
        \node [draw,circle] (x) at (0,0) {2};
        \node[draw,circle] (y) at (1,0) {3};
        \draw[->] (x) -- (y) {};
    }}}.
    \end{itemize} 
\end{example}
We introduce the concept of non-increasing occurrences. Intuitively, if a rule $\rho$ is $X$-non-increasing, then for any rewriting step using $\rho$, there is an injective mapping from the set of \( X \)-occurrences implicitly created by the step to the set of \( X \)-occurrences implicitly destroyed by the step. This intuition is made precise in Lemma~\ref{subgraph_counting:lem:w_u_l_not_geq_r_not}.
\begin{definition}[$X$-non-increasing rule]
    \label{subgraph_counting:def:creates_more_x_on_the_left}
    % Let \(\rho \mathop{=} (L \overset{l}{\leftarrowtail} K \overset{r}{\rightarrowtail} R)\) be a rule and \(X\) a graph. 
    % Let \( \Psi \) be a function associating $R' \mathop{\in} D(R,X)$ to a homomorphism in $\operatorname{Mono}(R',L)$.
    % We say that \textbf{the number of occurrences of $X$ is non-increasing from left to right in any $\rho$-rewriting step under the mapping \(\Psi\)}
    % (or that $\rho$ is $X$-\textbf{non-increasing} under $\Psi$. When $\Psi$ is clear from context or irrelevant to the discussion, we may simply say that $\rho$ is $X$-\textbf{non-increasing}.)
    Let \(\rho \mathop{=} (L \overset{l}{\leftarrowtail} K \overset{r}{\rightarrowtail} R)\) be a rule and \(X\) a graph. 
    Let \( \Psi \) be a function associating each $R' \mathop{\in} D(R,X)$ with a homomorphism in $\operatorname{Mono}(R',L)$.
    Rule $\rho$ is said to be $X$-\textbf{non-increasing}\index{$X$-non-increasing} under $\Psi$ 
    if the following four conditions hold:
    \begin{enumerate}
        \item For all $R' \mathop{\in} D(R,X)$, we can construct the following diagram where all morphisms other than $\Psi(R')$ are inclusion functions:
      \begin{center}
                \begin{tikzpicture} 
                    \node (k) at (0,-2) {$K$};
                    \node (k') at (0,0) {$K'$};
                    \node (l) at (-2,-2) {$L$};
                    \node (rb) at (-2,0) {$R'$};
                    \node (r) at (2,-2) {$R$};
                    \node (rb') at (2,0) {$R'$};

                    \draw[<-<]  (l) -- (k) node [midway,above] {$l$};
                    \draw[<-<]  (r) -- (k) node [midway,above] {$r$};
                    \draw[>->]  (k') -- (rb');
                    \draw[>->]  (rb') -- (r);
                    \draw[>->]  (k') -- (rb);
                    \draw[>->]  (k') -- (k);
                    \draw[>->]  (rb) -- (l) node [midway,left] {$\Psi(R')$};
                    \node () [at=($(k)!0.5!(rb)$)] {$PB$};
                    \node () [at=($(k)!0.5!(rb')$)] {$PB$}; 
                \end{tikzpicture}
        \end{center}
        % For all $R' \mathop{\in} D(R,X)$, in the diagram shown on the right, where $h_{R'R}$ is the inclusion function, both squares are pullbacks,
        % For all $R' \mathop{\in} D(R,X)$, there is a morphism \(h_{R'L}: R' \rightarrowtail L \) such that \trackedtext{both squares in the diagram shown on the right are pullbacks}, where all morphisms other than $h_{R'L}$, $l$ and $r$ are inclusion functions,
        \item \label{def:non_increasing:non_clapse} For all $R' \mathop{\in} D(R,X)$, for all nodes and edges $x$ in $R'$, if $ x \notin \operatorname{Im}(r)$ then 
        $\Psi(R')(x) \notin \operatorname{Im}(l)$,
        % $h_{R'L}(r') \notin \operatorname{Im}(l)$,
        \item \label{def:non_increasing_rule_img_edges_distinct} For all $R',R'' \mathop{\in} D(R,X)$, for all edges $x$ in $R'$ and $y$ in $R''$, if $x \mathop{\neq} y$, then $\Psi(R')(x) \mathop{\neq} \Psi(R'')(y)$,
        \item If $X$ has isolated nodes, then for all $R',R'' \mathop{\in} D(R,X)$ and nodes $x$ and $y$ in $R'$ and $R''$ respectively, if $x \mathop{\neq} y$, then $\Psi(R')(x) \mathop{\neq} \Psi(R'')(y)$.
    \end{enumerate} 
    When $\Psi$ is clear from context or irrelevant to the discussion, we may simply say that $\rho$ is $X$-\textbf{non-increasing}.
\end{definition}
The first condition ensures that whenever $R' \mathop{\in} D(R,X)$ forms an $X$-occurrence in the result graph $H$, this occurrence has a corresponding $X$-occurrence relative to the morphism $h_{R'L}$ (as defined in Definition~\ref{def:x_occurrence}) in the host graph $G$.
The second condition guarantees that any $X$-occurrence implicitly created by the rewriting step has its corresponding $X$-occurrence not included in the context (consequently, its corresponding $X$-occurrence is implicitly destroyed by the rewriting step). Example~\ref{subgraph_counting:ex:cond_2_necessaire} and Example~\ref{subgraph_counting:ex:cond_2_necessaire2} show the necessity of this condition.
The third and fourth conditions ensure that distinct $X$-occurrences created implicitly have distinct corresponding $X$-occurrences.
Example~\ref{subgraph_counting:ex:cond3_necessaire} and Example~\ref{subgraph_counting:ex:cond4_necessaire} show the necessity of these conditions.

The following example shows an $X$-non-increasing rule. 
\begin{example}
    \label{example:grs_aa:has_more_left}
    Consider the rule illustrated below and previously presented
    in Example~\ref{subgraph_counting:ex:grsaa_rx}.
    \begin{center}
        \resizebox{\textwidth}{!}{
        \begin{tikzpicture}
            \graphbox{$L$}{0mm}{0mm}{34mm}{15mm}{2mm}{-5mm}{
                \coordinate (o) at (0mm,-3mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                \node[draw,circle] (l3) at ($(l1)+(1,0)$) {3};
                \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                \draw[->] (l3) -- (l2) node[midway,above] {$a$};
            }     
            \graphbox{$K$}{40mm}{0mm}{24mm}{15mm}{2mm}{-5mm}{
                \coordinate (o) at (5mm,-3mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
            }    
            \graphbox{$R$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                \coordinate (o) at (-5mm,-3mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                \draw[->] (l3) -- (l4) node[midway,above] {$b$};
                \draw[->] (l4) -- (l2) node[midway,above] {$a$};
            }    
            \node () at (37mm,-8mm) {$\leftarrowtail$};
            \node () at (67mm,-8mm) {$\rightarrowtail$};
        \end{tikzpicture}
        }
    \end{center}
    Let $X$ be the graph \tikz[baseline=-0.5ex]{
        \node[draw,circle] (x) at (0,0) { };
        \node[draw,circle] (y) at (1,0) { };
        \node[draw,circle] (z) at (2,0) { };
        \draw[->] (x) -- (y) node[midway, above] {$a$};
        \draw[<-] (z) -- (y) node[midway, above] {$a$};
    }.
    As explained in Example~\ref{subgraph_counting:ex:grsaa_rx}, the set \( D(R,X) \) consists of exactly four graphs: $R'_1$, $R'_2$, $R'_3$ and $R'_4$.
    The rule is $X$-non-increasing under the function $\Psi$ that maps each $R'_i$ to the inclusion morphism from $R'_i$ to $L$. Specifically, it satisfies Condition 1 of Definition~\ref{subgraph_counting:def:creates_more_x_on_the_left}
     because the following diagrams
    %  in Figure~\ref{fig:subgraph_counting:decodkfjasddgsf} 
     can be constructed, and the remaining conditions in Definition~\ref{subgraph_counting:def:creates_more_x_on_the_left} are straightforward to verify.
    %1
    \begin{center}
        \resizebox{0.9\textwidth}{!}{
            \begin{tikzpicture}
                \graphbox{$R'_1$}{0mm}{0mm}{34mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (0mm,-3mm); 
                    \node (l1) at ($(o)+(-10mm,0mm)$) {};
                    \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {5};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$K'_1$}{40mm}{0mm}{24mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (5mm,-3mm); 
                    \node (l1) at ($(o)+(-10mm,0mm)$) {};
                    \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {$\ $};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$R'_1$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node (l1) at ($(o)+(-10mm,0mm)$) {};
                    \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l4) node[midway,above] {$b$};
                    \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$L$}{0mm}{-20mm}{34mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (0mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {5};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$K$}{40mm}{-20mm}{24mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {$\ $};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$R$}{70mm}{-20mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    \draw[->] (l3) -- (l4) node[midway,above] {$b$};
                    \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
                \node () at (37mm,-8mm) {$\leftarrowtail$};
                \node () at (17mm,-17mm) {$\Psi(R'_1)\downarrowtail$};
                \node () at (52mm,-17mm) {$\downarrowtail$};
                \node () at (92mm,-17mm) {$\downarrowtail$};
                \node () at (37mm,-18mm) {\text{PB}};
                \node () at (68mm,-18mm) {\text{PB}};
                \node () at (67mm,-8mm) {$\rightarrowtail$};
                \node () at (37mm,-28mm) {$\overset{l}{\leftarrowtail}$};
                \node () at (67mm,-28mm) {$\overset{r}{\rightarrowtail}$};
            \end{tikzpicture}
            }

            \vspace{2mm}
    %     \end{center}
    % % 2
    % \begin{center}
        \resizebox{0.9\textwidth}{!}{
            \begin{tikzpicture}
                \graphbox{$R'_2$}{0mm}{0mm}{34mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (0mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {5};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$K'_2$}{40mm}{0mm}{24mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {$\ $};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$R'_2$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l4) node[midway,above] {$b$};
                    \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$L$}{0mm}{-20mm}{34mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (0mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {5};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$K$}{40mm}{-20mm}{24mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {$\ $};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$R$}{70mm}{-20mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    \draw[->] (l3) -- (l4) node[midway,above] {$b$};
                    \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
                \node () at (37mm,-8mm) {$\leftarrowtail$};
                \node () at (17mm,-17mm) {$\Psi(R'_2)\downarrowtail$};
                \node () at (52mm,-17mm) {$\downarrowtail$};
                \node () at (92mm,-17mm) {$\downarrowtail$};
                \node () at (37mm,-18mm) {\text{PB}};
                \node () at (68mm,-18mm) {\text{PB}};
                \node () at (67mm,-8mm) {$\rightarrowtail$};
                \node () at (37mm,-28mm) {$\overset{l}{\leftarrowtail}$};
                \node () at (67mm,-28mm) {$\overset{r}{\rightarrowtail}$};
            \end{tikzpicture}
            }
    %     \end{center}    
    % %3
    % \begin{center}

                \vspace{2mm}
        \resizebox{0.9\textwidth}{!}{
            \begin{tikzpicture}
                \graphbox{$R'_3$}{0mm}{0mm}{34mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (0mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    % \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$K'_3$}{40mm}{0mm}{24mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    % \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {$\ $};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$R'_3$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    % \node[draw,circle] (l2) at ($(l1)+(3,0)$) {4};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    % \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l4) node[midway,above] {$b$};
                    % \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$L$}{0mm}{-20mm}{34mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (0mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$K$}{40mm}{-20mm}{24mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {$\ $};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$R$}{70mm}{-20mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    \draw[->] (l3) -- (l4) node[midway,above] {$b$};
                    \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
                \node () at (37mm,-8mm) {$\leftarrowtail$};
                \node () at (17mm,-17mm) {$\Psi(R'_3)\downarrowtail$};
                \node () at (52mm,-17mm) {$\downarrowtail$};
                \node () at (92mm,-17mm) {$\downarrowtail$};
                \node () at (37mm,-18mm) {\text{PB}};
                \node () at (68mm,-18mm) {\text{PB}};
                \node () at (67mm,-8mm) {$\rightarrowtail$};
                \node () at (37mm,-28mm) {$\overset{l}{\leftarrowtail}$};
                \node () at (67mm,-28mm) {$\overset{r}{\rightarrowtail}$};
            \end{tikzpicture}
            }

                        \vspace{2mm}
        \resizebox{0.9\textwidth}{!}{
            \begin{tikzpicture}
                \graphbox{$R'_4$}{0mm}{0mm}{34mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (0mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$K'_4$}{40mm}{0mm}{24mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {$\ $};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$R'_4$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    % \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l4) node[midway,above] {$b$};
                    % \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$L$}{0mm}{-20mm}{34mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (0mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$K$}{40mm}{-20mm}{24mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {$\ $};
                    % \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$R$}{70mm}{-20mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                    \draw[->] (l1) -- (l3) node[midway,above] {$a$};
                    \draw[->] (l3) -- (l4) node[midway,above] {$b$};
                    \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
                \node () at (37mm,-8mm) {$\leftarrowtail$};
                \node () at (17mm,-17mm) {$\Psi(R'_4)\downarrowtail$};
                \node () at (52mm,-17mm) {$\downarrowtail$};
                \node () at (92mm,-17mm) {$\downarrowtail$};
                \node () at (37mm,-18mm) {\text{PB}};
                \node () at (68mm,-18mm) {\text{PB}};
                \node () at (67mm,-8mm) {$\rightarrowtail$};
                \node () at (37mm,-28mm) {$\overset{l}{\leftarrowtail}$};
                \node () at (67mm,-28mm) {$\overset{r}{\rightarrowtail}$};
            \end{tikzpicture}
        }
    \end{center}

    To illustrate the $X$-non-increasing property captured by Definition~\ref{subgraph_counting:def:creates_more_x_on_the_left},
    consider the rewriting step defined by the DPO diagram below.
    \begin{center}
        \resizebox{\textwidth}{!}{
        \begin{tikzpicture}
            \graphbox{\( L \)}{0mm}{2mm}{34mm}{15mm}{2mm}{-1mm}{
                \coordinate (o) at (0mm,-8mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                \node[draw,circle] (l3) at ($(l1)+(1,0)$) {3};
                \draw[] (l1) -- (l3) node[midway,above] {$a$};
                \draw[] (l3) -- (l2) node[midway,above] {$a$};
            } 

            \graphbox{\( K \)}{40mm}{2mm}{34mm}{15mm}{2mm}{-1mm}{
                \coordinate (o) at (0mm,-8mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
            }  

            \graphbox{\( R \)}{80mm}{2mm}{45mm}{15mm}{2mm}{-1mm}{
                \coordinate (o) at (-5mm,-8mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                \draw[ ] (l1) -- (l3) node[midway,above] {$a$};
                \draw[ ] (l3) -- (l4) node[midway,above] {$b$};
                \draw[ ] (l4) -- (l2) node[midway,above] {$a$};
            }    

            \graphbox{\( G \)}{0mm}{-19mm}{34mm}{24mm}{2mm}{-6mm}{
                \coordinate (o) at (0mm,-3mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                \node[draw,circle] (l3) at ($(l1)+(1,0)$) {3};
                \node[draw,circle] (l4) at ($(l2)+(0,-1)$) {6};
                \draw[] (l1) -- (l3) node[midway,above] {$a$};
                \draw[] (l3) -- (l2) node[midway,above] {$a$};
                \draw[ ] (l2) -- (l4) node[midway,right] {$a$};
                \node[draw,circle] (l6) at ($(l1)+(0,-1)$) {7};
                \draw[] (l1) -- (l6) node[midway,left] {$a$};
            }    

            \graphbox{\( C  \)}{40mm}{-19mm}{34mm}{24mm}{2mm}{-6mm}{
                \coordinate (o) at (0mm,-3mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                \node[draw,circle] (l4) at ($(l2)+(0,-1)$) {6};
                \draw[ ] (l2) -- (l4) node[midway,right] {$a$};
                \node[ draw,circle] (l6) at ($(l1)+(0,-1)$) {7};
                \draw[ ] (l1) -- (l6) node[midway,left] {$a$};
            }    

            \graphbox{\( H  \)}{80mm}{-19mm}{45mm}{24mm}{2mm}{-6mm}{
                \coordinate (o) at (-5mm,-3mm); 
                \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                \node[draw,circle] (l3) at ($(l1)+(1,0)$) {4};
                \node[draw,circle] (l4) at ($(l1)+(2,0)$) {5};
                \node[ draw,circle] (l5) at ($(l2)+(0,-1)$) {6};
                \node[ draw,circle] (l6) at ($(l1)+(0,-1)$) {7};
                \draw[ ] (l1) -- (l6) node[midway,left] {$a$};
                \draw[] (l1) -- (l3) node[midway,above] {$a$};
                \draw[] (l3) -- (l4) node[midway,above] {$b$};
                \draw[ ] (l4) -- (l2) node[midway,above] {$a$};
                \draw[ ] (l2) -- (l5) node[midway,right] {$a$};
            }    
            \node () at (37mm,-16mm) {\text{PO}};
            \node () at (78mm,-16mm) {\text{PO}};
            \node () at (37mm,-8mm) {\( \leftarrowtail \)}; % K -> L
            \node () at (77mm,-8mm) {\( \rightarrowtail \)}; % K -> R
            \node () at (17mm,-16mm) {\( m\ \downarrowtail \)};
            \node () at (37mm,-33mm) {\( \leftarrowtail \)};
            \node () at (52mm,-16mm) {\( \downarrowtail \)};
            \node () at (92mm,-16mm) {\( \downarrowtail \)};
            \node () at (77mm,-33mm) {\( \rightarrowtail \)}; % C -> H
        \end{tikzpicture}
        }
    \end{center}
    Whenever \( R'_i \) (for \( 1 \leq i \leq 4 \)) forms an \( X \)-occurrence $x$ in $H$ that is included in neither \( R \) nor $C$, and whose intersection with $C$ is a subgraph $C' \mathop{\subseteq} C \mathop{\cap} x \mathop{\subseteq} C$, the graph
    \( \operatorname{\Psi(R')} \mathop{\subseteq} L\) forms
    a corresponding \( X \)-occurrence in $G$ with the same $C'$, which is included in neither \( L \) nor $C$.
    Furthermore, distinct $X$-occurrences in $H$ that are included neither in \( R \) nor in $C$ have distinct corresponding $X$-occurrences in $G$ that are included neither in \( L \) nor in $C$.
\end{example}
% cond 2 necessaire  1
\begin{example} 
    \label{subgraph_counting:ex:cond_2_necessaire}
    Let $X$ be the graph 
    \tikz[baseline=-0.5ex]{ 
            \node[draw,circle] (x) at (0,0) {}; 
            \node[draw,circle] (y) at (1,0) {};
            \node[draw,circle] (z) at (2,0) {};
            \draw[->] (x) -- (y)   {};
            \draw[->] (y) -- (z)   {};
    }. The rewriting rule shown below
    is not necessarily $X$-non-increasing.
    \begin{center}
        \resizebox{\textwidth}{!}{
            \begin{tikzpicture}
                \graphbox{$L$}{0mm}{0mm}{34mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (0mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    % \node[draw,circle] (l2) at ($(l1)+(2,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {2};
                    \draw[->] (l3) -- (l1) node[midway,above] {};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }     
                \graphbox{$K$}{40mm}{0mm}{24mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
                    % \node[draw,circle] (l3) at ($(l1)+(1,0)$) {$\ $};
                    \draw[->] (l2) -- (l1) node[midway,above] {};
                    % \draw[->] (l3) -- (l2) node[midway,above] {$a$};
                }    
                \graphbox{$R$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    % \node[draw,circle] (l2) at ($(l1)+(3,0)$) {2};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {2};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {3};
                    \draw[->] (l3) -- (l1) node[midway,above] {};
                    \draw[->] (l3) -- (l4) node[midway,above] {};
                    % \draw[->] (l4) -- (l2) node[midway,above] {$a$};
                }    
                \node () at (37mm,-8mm) {$\leftarrowtail$};
                \node () at (67mm,-8mm) {$\rightarrowtail$};
            \end{tikzpicture}
        }
      \end{center}

    As shown in Example~\ref{subgraph_counting:ex:rx_counter_ex}, \( D(R,X) \) contains the graph $R'$:
    \raisebox{2pt}{
        \scalebox{0.6}{\tikz[baseline=-0.5ex]{
        \node [draw,circle] (x) at (0,0) {2};
        \node[draw,circle] (y) at (1,0) {3};
        \draw[->] (x) -- (y) {};
    }}}. The unique monomorphism $h_{R'L}:R' \rightarrowtail L$ fails the second condition of Definition~\ref{subgraph_counting:def:creates_more_x_on_the_left}. 
    For any rewriting step using this rule, the corresponding $X$-occurrence relative to $h_{R'L}$ of any implicitly created $X$-occurrence is included in the context.
\end{example}
% cond 2 necessaire  2
\begin{example}
    \label{subgraph_counting:ex:cond_2_necessaire2}
    Let $X$ be the graph 
    \tikz[baseline=-0.5ex]{ 
            \node[draw,circle] (x) at (0,0) {}; 
            \node[draw,circle] (y) at (1,0) {};
            \node[draw,circle] (z) at (2,0) {};
            \draw[->] (x) -- (y)   {};
            % \draw[->] (y) -- (z)   {};
    }. The rewriting rule shown below
    % in Figure~\ref{fig:subgraph_counting:degkdjfqaaacodkfjasddgsf} 
    is not necessarily $X$-non-increasing.
    % \begin{figure}[H]
    %     \centering
    \begin{center}
        \resizebox{\textwidth}{!}{
            \begin{tikzpicture}
                \graphbox{$L$}{0mm}{0mm}{34mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (0mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {2};
                }     
                \graphbox{$K$}{40mm}{0mm}{24mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l2) at ($(l1)+(1,0)$) {2};
                }    
                \graphbox{$R$}{70mm}{0mm}{45mm}{15mm}{2mm}{-5mm}{
                    \coordinate (o) at (-5mm,-3mm); 
                    \node[draw,circle] (l1) at ($(o)+(-10mm,0mm)$) {1};
                    \node[draw,circle] (l3) at ($(l1)+(1,0)$) {2};
                    \node[draw,circle] (l4) at ($(l1)+(2,0)$) {3};
                }    
                \node () at (37mm,-8mm) {$\leftarrowtail$};
                \node () at (67mm,-8mm) {$\rightarrowtail$};
            \end{tikzpicture}
        }
    \end{center}
    The set \( D(R,X) \) contains $R'$:
    \raisebox{2pt}{ \scalebox{0.6}{\tikz[baseline=-0.5ex]{
        \node [draw,circle] (x) at (0,0) {1};
        \node[draw,circle] (y) at (1,0) {3};
    }}}.  
    Despite the existence of a unique monomorphism $h_{R'L}: R' \rightarrowtail L$ preserving interface elements, this rule fails the second condition of Definition~\ref{subgraph_counting:def:creates_more_x_on_the_left}.
    For any rewriting step using this rule, the corresponding $X$-occurrence relative to $h_{R'L}$ of any implicitly created $X$-occurrence is included in the context.
\end{example}
\begin{example}
    \label{subgraph_counting:ex:cond3_necessaire}
    Let $X$ be the graph 
    \tikz[baseline=-0.5ex]{ 
            \node[draw,circle] (x) at (0,0) { }; 
            \node[draw,circle] (y) at (1,0) { };
            \node[draw,circle] (z) at (2,0) { };
            \draw[->] (x) -- (y)   {};
            \draw[->] (y) -- (z) {};
    }. The rewriting rule shown below
    % in Figure~\ref{fig:subgraph_counting:decodkfjasdddfsfdsagsf} 
    is not necessarily $X$-non-increasing.
    % \begin{figure}[H]
    %     \centering
    \begin{center}
        \resizebox{\textwidth}{!}{
            \begin{tikzpicture}
                \graphbox{$L$}{0mm}{0mm}{30mm}{20mm}{0}{0}{
                    \node[draw,circle]  (x) at (-6mm,-12mm) {x};
                    \node[draw,circle] (y) at (6mm,-12mm) {};
                    % \node[draw,circle]  (z) at (6mm,0mm) {};
                    \draw[->]  (x) to (y);
                    % \draw[->] (y) to[bend right=20] (z);
                    % \draw[->]  (z) to[bend right=20] (y);
                }
                \graphbox{$K$}{40mm}{0mm}{30mm}{20mm}{0}{0}{
                    \node[draw,circle]  (x) at (-6mm,-12mm) {x};
                    % \node[draw,circle]  (y) at (6mm,-12mm) {y};
                }
                \graphbox{$R$}{80mm}{0mm}{30mm}{20mm}{0}{0}{
                    \node[draw,circle]  (x) at (-6mm,-12mm) {x};
                        \node[draw,circle]  (y) at (6mm,-8mm) {y};
                        \node[draw,circle]  (z) at (6mm,-16mm) {z};
                        \draw[->]  (x) to (y);
                        \draw[->]  (x) to (z);
                }
                \node () at (35mm,-12mm) {$\leftarrowtail$};
                \node () at (75mm,-12mm) {$\rightarrowtail$};
            \end{tikzpicture}
        }
    \end{center}
    The set \( D(R,X) \) contains exactly two elements $R'$:
    \raisebox{2pt}{ 
        \scalebox{0.6}{\tikz[baseline=-0.5ex]{
        \node [draw,circle] (x) at (0,0) {x};
        \node[draw,circle] (y) at (1,0) {y};
        \draw[->] (x) -- (y) {};
    }}} and $R''$:\raisebox{2pt}{ 
        \scalebox{0.6}{\tikz[baseline=-0.5ex]{
        \node [draw,circle] (x) at (0,0) {x};
        \node[draw,circle] (y) at (1,0) {z};
        \draw[->] (x) -- (y) {};
    }}}. 
    Despite the unique monomorphisms \( h_{R'L}: R' \rightarrowtail L \) and \( h_{R''L}: R'' \rightarrowtail L \) preserving interface elements, they fail the third condition of Definition~\ref{subgraph_counting:def:creates_more_x_on_the_left}. 
    For any rewriting step using this rule, implicitly created $X$-occurrences with the same subgraph of the context have the same corresponding $X$-occurrence. 
\end{example}
 
\begin{example}
    \label{subgraph_counting:ex:cond4_necessaire} 
    Let $X$ be the graph 
    \tikz[baseline=-0.5ex]{ 
            \node[draw,circle] (x) at (0,0) { }; 
            \node[draw,circle] (y) at (1,0) { };
            \node[draw,circle] (z) at (2,0) { };
            \draw[->] (x) -- (y)   {};
    }, which has an isolated node. The rewriting rule shown below
    % in Figure~\ref{fig:subgraph_counting:decodkfjasddgdfsgassf} 
    is not necessarily $X$-non-increasing.
    % \begin{figure}[H]
    %     \centering
    \begin{center}
        \resizebox{\textwidth}{!}{
            \begin{tikzpicture}
                \graphbox{$L$}{0mm}{0mm}{30mm}{20mm}{0}{0}{
                    \node[draw,circle]  (x) at (-6mm,-10mm) {x};
                    \node[draw,circle] (y) at (6mm,-10mm) {y};
                }
                \graphbox{$K$}{40mm}{0mm}{30mm}{20mm}{0}{0}{
                    \node[draw,circle]  (x) at (-6mm,-10mm) {x};
                }
                \graphbox{$R$}{80mm}{0mm}{30mm}{20mm}{0}{0}{
                    \node[draw,circle]  (x) at (-6mm,-10mm) {x};
                        \node[draw,circle]  (y) at (6mm,-6mm) {z};
                        \node[draw,circle]  (z) at (6mm,-14mm) {w};
                }
                \node () at (35mm,-10mm) {$\leftarrowtail$};
                \node () at (75mm,-10mm) {$\rightarrowtail$};
            \end{tikzpicture}
        }
    \end{center}
    The set \( D(R,X) \) contains exactly two elements $R'$:
    \raisebox{2pt}{\scalebox{0.6}{\tikz[baseline=-0.5ex]{
        \node [draw,circle] (x) at (0,0) {x};
        \node[draw,circle] (y) at (1,0) {z};
        % \draw[->] (x) -- (y) {};
    }}} and $R''$:
    \raisebox{2pt}{\scalebox{0.6}{\tikz[baseline=-0.5ex]{
        \node [draw,circle] (x) at (0,0) {x};
        \node[draw,circle] (y) at (1,0) {w};
        % \draw[->] (x) -- (y) {};
    }}}. 
    There are unique monomorphisms $h_{R'L}:R' \rightarrowtail L$ and $h_{R''L}:R'' \rightarrowtail L$ preserving interface elements, but they fail the fourth condition of Definition~\ref{subgraph_counting:def:creates_more_x_on_the_left}.
    For any rewriting step using this rule, implicitly created $X$-occurrences with the same subgraph of the context have the same corresponding $X$-occurrence.
\end{example}


\section{Solution to the key challenge}
\label{subgraph_counting:sec:solution_to_the_key_challenge}
The following lemma formalizes the intuition that if $\rho$ is $X$-non-increasing, then, for any rewriting step using $\rho$, 
more $X$-occurrences are implicitly destroyed than implicitly created by the rewriting step.
\begin{lemma} 
    \label{subgraph_counting:lem:w_u_l_not_geq_r_not}
        Let $X$ be a ruler-graph and $\rho \mathop{=} (L \overset{l}{\leftarrowtail} K \overset{r}{\rightarrowtail} R)$ an injective DPO rewriting rule.
        Suppose that $\rho$ is $X$-non-increasing. For every rewriting step induced by the following DPO diagram:
        \begin{center}
            \begin{tikzpicture}
                \node (k) at (0,1) {K};
                \node (l) at (-2,1) {L};
                \node (r) at (2,1) {R};
                \node (c) at (0,-1) {C};
                \node (g) at (-2,-1) {G};
                \node (h) at (2,-1) {H};
                \draw[<-<]  (l) -- (k) node [midway,below] {$l$};
                \draw[>->]  (k) -- (r) node [midway,below] {$r$};
                \draw[>->] (c) -- (g) node [midway, above] {$l'$};
                \draw[>->] (c) -- (h) node [midway,above] {$r'$};
                \draw[>->] (l) -- (g) node[midway, right] {$m$};
                \draw[>->] (r) -- (h) node[midway, left] {$m'$};
                \draw[>->] (k) -- (c) node[midway, left] {};
                \node () [at=($(l)!0.5!(c)$)] {$PO$};
                \node () [at=($(r)!0.5!(c)$)] {$PO$};
            \end{tikzpicture}
        \end{center}
       The following inequality holds:
        \[
            |\operatorname{Mono}(X, G, \lnot m, \lnot l')| \mathop{\geq} |\operatorname{Mono}(X, H, \lnot m', \lnot r')|
        \]
\end{lemma}
\begin{proof}
        See~\textsection~\ref{proof:lem:w_u_l_not_geq_r_not}.
\end{proof} 
